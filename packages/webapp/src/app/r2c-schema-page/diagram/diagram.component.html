<div class="zoom-container">
  <div class="svg-container">
    @let graphLayout = layout()?.graph();
    <svg
      xmlns="http://www.w3.org/2000/svg"
      id="svg-output-{{ id }}"
      #svg
      [attr.width]="graphLayout?.width"
      [attr.height]="graphLayout?.height"
      [attr.viewBox]="'0 0 ' + graphLayout?.width + ' ' + graphLayout?.height"
    >
      @for (e of layout()?.edges(); track e) {
        @let edge = layout().edge(e);
        @if (!edge.invisible) {
          <path [attr.d]="getEdgePath(edge)"></path>
        }
      }
      @for (table of schema()?.tables; track table.url) {
        @let tableLayout = layout()?.node(table.url);
        <foreignObject
          [attr.x]="tableLayout?.x - tableLayout?.width / 2"
          [attr.y]="tableLayout?.y - tableLayout?.height / 2"
          [attr.width]="tableLayout?.width || 1000"
          [attr.height]="tableLayout?.height || 1000"
        >
          <app-table-schema
            [data]="table"
            [allTables]="schema().tables"
            (deleteCol)="deleteColumn(table.url, $event.name, $event.titles)"
            (deleteTable)="deleteTable(table.url)"
            (moveCol)="
              moveColumn(
                table.url,
                $event.column,
                $event.columnTitles,
                $event.toTable
              )
            "
            (renameCol)="renameColumn(table.url, $event.name, $event.titles)"
            (renameTable)="renameTable(table.url)"
          ></app-table-schema>
        </foreignObject>
      }
    </svg>
  </div>
</div>

<button matFab (click)="addTable()" aria-label="Add Table">
  <mat-icon>add</mat-icon>
</button>
